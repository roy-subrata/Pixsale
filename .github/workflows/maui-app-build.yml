name: Build MAUI App

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
    paths-ignore:
      - "**.md"
      - "**/*.gitignore"
      - "**/*.gitattributes"
      - "**/*.yml"

jobs:
  build-windows:
    runs-on: windows-latest
    name: üîµ Build Windows
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: "9.0.x" # or 7.0.x if your MAUI version is older

      - name: Install MAUI Workload
        run: dotnet workload install maui

      - name: Build for Windows
        run: dotnet publish src/Services/Pixsale.App/Pixsale.App.csproj -f net9.0-windows10.0.19041.0 -c Release

  build-web:
    runs-on: windows-latest
    name: üåê Build Web (Blazor WASM)
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: "9.0.x"

      - name: Install MAUI Workload
        run: dotnet workload install maui

      - name: Build Blazor WebAssembly
        run: dotnet publish src/Services/Pixsale.Web/Pixsale.Web.csproj -f net9.0 -c Release

  build-android:
    runs-on: windows-latest
    name: ü§ñ Build Android
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: "9.0.x"

      - name: Install MAUI + Android Workload
        run: dotnet workload install maui-android

      - name: Build Android APK
        run: dotnet publish src/Services/Pixsale.App/Pixsale.App.csproj -f net9.0-android -c Release -p:AndroidPackageFormat=apk
